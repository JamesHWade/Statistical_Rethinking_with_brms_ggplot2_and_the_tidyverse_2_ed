{
  "hash": "0901533dbc874b823c413c7854b78135",
  "result": {
    "markdown": "--- \ncsl: apa.csl\nlink-citations: yes\ngeometry:\n  margin = 0.5in\nurlcolor: blue\nhighlight: tango\ngithub-repo: ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed\ntwitter-handle: SolomonKurz\ndescription: \"This book is an attempt to re-express the code in the second edition of McElreath's textbook, 'Statistical rethinking.' His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style.\"\n---\n\n\n# Preface {.unnumbered}\n\n### What and why {-}\n\nThis ebook is based on the second edition of [Richard McElreath](https://twitter.com/rlmcelreath)'s [-@mcelreathStatisticalRethinkingBayesian2020] text, [*Statistical rethinking: A Bayesian course with examples in R and Stan*](https://xcelab.net/rm/statistical-rethinking/). My contributions show how to fit the models he covered with [Paul BÃ¼rkner](https://twitter.com/paulbuerkner)'s [**brms** package](https://github.com/paul-buerkner/brms) [@R-brms; @burknerBrmsPackageBayesian2017; @burknerAdvancedBayesianMultilevel2018], which makes it easy to fit Bayesian regression models in **R** [@R-base] using Hamiltonian Monte Carlo. I also prefer plotting and data wrangling with the packages from the [**tidyverse**](https://www.tidyverse.org/) [@R-tidyverse; @wickhamWelcomeTidyverse2019]. So we'll be using those methods, too.\n\nAre you looking for the companion ebook for McElreath's 1st edition? [Click here.](https://bookdown.org/content/3890/)\n\n## My assumptions about you {-}\n\nIf you're looking at this project, I'm guessing you're either a graduate student, a post-graduate academic or a researcher of some sort, which suggests you have at least a 101-level foundation in statistics. If you're rusty, consider checking out the free text books by [Roback and Legler](https://bookdown.org/roback/bookdown-BeyondMLR/) [-@roback2021beyond] or [Navarro](https://learningstatisticswithr.com/) [-@navarroLearningStatistics2019] before diving into *Statistical rethinking*. I'm also assuming you understand the rudiments of **R** and have at least a vague idea about what the **tidyverse** is. If you're totally new to **R**, consider starting with Peng's [-@pengProgrammingDataScience2022] [*R programming for data science*](https://bookdown.org/rdpeng/rprogdatascience/). For an introduction to the **tidyvese**-style of data analysis, the best source I've found is Grolemund and Wickham's [-@grolemundDataScience2017] [*R for data science*](http://r4ds.had.co.nz) (*R4DS*), which I extensively link to throughout this project. Another nice alternative is Baumer, Kaplan, and Horton's [-@baumerMocernDataScienceR2021], [*Modern data science with R*](https://mdsr-book.github.io/mdsr2e/).\n\nHowever, you do not need to be totally fluent in statistics or **R**. Otherwise why would you need this project, anyway? IMO, the most important things are curiosity, a willingness to try, and persistent tinkering. I love this stuff. Hopefully you will, too.\n\n## How to use and understand this project {-}\n\nThis project is not meant to stand alone. It's a supplement to the second edition of McElreath's text. I follow the structure of his text, chapter by chapter, translating his analyses into **brms** and **tidyverse**-style code. However, some of the sections in the text are composed entirely of equations or prose, leaving us nothing to translate. When we run into those sections, the corresponding sections in this project will sometimes be blank or omitted, though I do highlight some of the important points in quotes and prose of my own. So I imagine students might reference this project as they progress through McElreath's text. I also imagine working data analysts might use this project in conjunction with the text as they flip to the specific sections that seem relevant to solving their data challenges.\n\nI reproduce the bulk of the figures in the text, too. The plots in the first few chapters are the closest to those in the text. However, I'm passionate about data visualization and like to play around with [color palettes](https://github.com/EmilHvitfeldt/r-color-palettes), formatting templates, and other conventions quite a bit. As a result, the plots in each chapter have their own look and feel. For more on some of these topics, check out chapters [3](https://r4ds.had.co.nz/data-visualisation.html), [7](https://r4ds.had.co.nz/exploratory-data-analysis.html), and [28](https://r4ds.had.co.nz/graphics-for-communication.html) in *R4DS*; Healy's [-@healyDataVisualization2018] [*Data visualization: A practical introduction*](https://socviz.co); Wilke's [-@wilkeFundamentalsDataVisualization2019] [*Fundamentals of data visualization*](https://serialmentor.com/dataviz/); or Wickham's [-@wickhamGgplot2ElegantGraphics2016] [*ggplot2: Elegant graphics for data analysis*](https://ggplot2-book.org/).\n\nIn this project, I use a handful of formatting conventions gleaned from [*R4DS*](https://r4ds.had.co.nz/introduction.html#running-r-code), [*The tidyverse style guide*](https://style.tidyverse.org/) [@wickhamTidyverseStyleGuide2020], and [*R markdown: The definitive guide*](https://bookdown.org/yihui/rmarkdown/software-info.html) [@xieMarkdownDefinitiveGuide2020].\n\n* **R** code blocks and their output appear in a gray background. E.g.,\n\n\n::: {.cell}\n\n```{.r .cell-code}\n2 + 2 == 5\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n:::\n\n\n* **R** and the names of specific package (e.g., **brms**) are in **boldface** font.\n* Functions are in a typewriter font and followed by parentheses, all atop a gray background (e.g., `brm()`).\n* When I want to make explicit the package a given function comes from, I insert the double-colon operator `::` between the package name and the function (e.g., `tidybayes::median_qi()`).\n* **R** objects, such as data or function arguments, are in typewriter font atop gray backgrounds (e.g., `chimpanzees`, `.width = .5`).\n* You can detect hyperlinks by their typical [blue-colored font](https://solomonkurz.netlify.app/).\n* In the text, McElreath indexed his models with names like `m4.1` (i.e., the first model of [Chapter 4][Geocentric Models]). I primarily followed that convention, but replaced the `m` with a `b` to stand for the **brms** package.\n\n## **R** setup\n\nTo get the full benefit from this ebook, you'll need some software. Happily, everything will be free (provided you have access to a decent personal computer and an good internet connection).\n\nFirst, you'll need to install **R**, which you can learn about at [https://cran.r-project.org/](https://cran.r-project.org/).\n\nThough not necessary, your **R** experience might be more enjoyable if done through the free RStudio interface, which you can learn about at [https://rstudio.com/products/rstudio/](https://rstudio.com/products/rstudio/).\n\nOnce you have installed **R**, execute the following to install the bulk of the add-on packages. This will probably take a few minutes to finish. Go make yourself a coffee.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npackages <- c(\"ape\", \"bayesplot\", \"brms\", \"broom\", \"dagitty\", \"devtools\", \"flextable\", \"GGally\", \"ggdag\", \"ggdark\", \"ggmcmc\", \"ggrepel\", \"ggthemes\", \"ggtree\", \"ghibli\", \"gtools\", \"invgamma\", \"loo\", \"patchwork\", \"posterior\", \"psych\", \"rcartocolor\", \"Rcpp\", \"remotes\", \"rstan\", \"santoku\", \"StanHeaders\", \"statebins\", \"tidybayes\", \"tidyverse\", \"viridis\", \"viridisLite\", \"wesanderson\")\n\ninstall.packages(packages, dependencies = T)\n```\n:::\n\n\nA few of the other packages are not officially available via the Comprehensive R Archive Network (CRAN; https://cran.r-project.org/). You can download them directly from GitHub by executing the following.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# the cmdstanr developers recommend running this is a fresh R session or \n# restarting your current session\ninstall.packages(\"cmdstanr\", repos = c(\"https://mc-stan.org/r-packages/\", getOption(\"repos\")))\n# you likely them need to install cmdstan\ncmdstanr::install_cmdstan()\ndevtools::install_github(\"EdwinTh/dutchmasters\")\ndevtools::install_github(\"gadenbuie/ggpomological\")\ndevtools::install_github(\"GuangchuangYu/ggtree\")\ndevtools::install_github(\"rmcelreath/rethinking\")\ndevtools::install_github(\"UrbanInstitute/urbnmapr\")\n```\n:::\n\n\nIt's possible you'll have problems installing some of these packages. Here are some likely suspects and where you can find help:\n\n* for difficulties installing **brms**, go to [https://github.com/paul-buerkner/brms#how-do-i-install-brms](https://github.com/paul-buerkner/brms#how-do-i-install-brms) or search around in the [**brms** section of the Stan forums ](https://discourse.mc-stan.org/c/interfaces/brms/36);\n* for difficulties installing **cmdstanr**, go to [https://mc-stan.org/cmdstanr/articles/cmdstanr.html](https://mc-stan.org/cmdstanr/articles/cmdstanr.html);\n* for difficulties installing **rethinking**, go to [https://github.com/rmcelreath/rethinking#installation](https://github.com/rmcelreath/rethinking#installation); and\n* for difficulties installing **rstan**, go to [https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started](https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started).\n\n## We have updates {-}\n\nFor a brief rundown of the version history, we have:\n\n### Version 0.1.0. {-}\n\nI released the 0.1.0 version of this project in November 24, 2020. It was the first full-length and nearly complete draft including material from all the 17 chapters in McElreath's source material. All **brms** models were fit with version 2.14.0+. \n\n### Version 0.1.1. {-}\n\nOn December 2, 2020, I released a mini update designed to \n\n* fix code breaks resulting from updates to the [**broom** package](https://CRAN.R-project.org/package=broom) [@R-broom], caught by [Jenny Bigman](https://twitter.com/jennybigman);\n* replace the soon-to-be retired `sample_n()` code with `slice_sample()`, caught by [Randall Pruim](https://github.com/rpruim);\n* and correct a few typos along the way.\n\n### Version 0.2.0. {-}\n\nOn March 16, 2021, I released version 0.2.0, which included the following major improvements:\n\n* a corrected workflow for fitting single-level b-spline models ([Section 4.5.2][Splines.]), thanks to [Stephen Wild](https://github.com/sjwild);\n* a refined workflow for fitting multilevel b-spline models using the `s()` function ([Section 4.6][~~Summary~~ First bonus: Smooth functions with `brms::s()`]), thanks to [Gavin Simpson](https://github.com/gavinsimpson);\n* a new bonus section ([4.7][Second bonus: Group predictors with matrix columns]) on grouping predictors within matrix columns, thanks to insights from @gelmanRegressionOtherStories2020 and [hints](https://discourse.mc-stan.org/t/fit-a-brm-model-with-an-array-of-predictors/20465) from [Paul-Christian BÃ¼rkner](https://github.com/paul-buerkner);\n* a **brms** solution to the $\\sigma = 0.01$ sixth-order polynomial model in [Section 7.1.1][More parameters (almost) always improve fit.], thanks again to Stephen Wild;\n* a workflow to reproduce the Metropolis simulation for [Figure 9.3][High-dimensional problems.], thanks to [James Henegan](https://github.com/jameshenegan);\n* a corrected workflow for taking `fitted()`-based random draws for the bonus material in [Section 13.5.2.1][Bonus: Let's use `fitted()` this time.], thanks to an exchange with [Ladislas Nalborczyk](https://github.com/lnalborczyk); \n* a **brms** solution to McElreath's bivariate differential equation model in [Section 16.4][Population dynamics], thanks to [Markus Gesmann](https://github.com/mages);\n* better use of `geom_area()` throughout the book, thanks to insights from [Randall Pruim](https://github.com/rpruim);\n* the adoption of a [CONTRIBUTING](https://github.com/ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed/blob/master/CONTRIBUTING.md) section on GitHub, thanks to [Brenton M. Wiernik](https://github.com/bwiernik);\n* improved table workflow with the **flextable** package [@R-flextable]; and\n* all models have been refit using **brms** version 2.15.0.\n\n### Version 0.3.0. {-}\n\nWelcome to version 0.3.0! Major improvements include:\n\n* an `as_draws_df()`-oriented workflow to replace the depreciated `posterior_samples()` function;\n* better sampling in models in the first few due to changes in the `ub` argument;\n* more use of the uniform prior for $\\sigma$ to better match the text, thanks to the improved `ub` argument;\n* a more **tidyverse**-oriented version of the `sim_happiness()` function in [Section 6.3][Collider bias], thanks to [Randall Pruim](https://github.com/rpruim)\n* a more accurate depiction of entropy in Figure 10.2.b in [Section 10.1.1][Gaussian.], thanks to help from [Hamed Bastan-Hagh](https://github.com/hamedbh), \n* a cross link to the first edition, thanks to a suggestion from [Will Petry](https://github.com/wpetry);\n* some corrected typos and updates to the links and citations; and\n* all models have been refit using **brms** version 2.18.0.\n\n### We're not done yet and I could use your help. {-}\n\nSome areas of the book could use some fleshing out. The sections I'm particularly anxious to improve are\n\n* [15.3][Categorical errors and discrete absences], which may someday include a **brms** workflow for categorical missing data; and\n* [16.2.3][Coding the statistical model.], which contains a mixture model that McElreath fit directly in Stan and I suspect may be possible in **brms** with a custom likelihood.\n\nIf you have insights on how to improve these or any other sections, please share your thoughts on GitHub at [https://github.com/ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed/issues](https://github.com/ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed/issues). The contribution guidelines for this book are listed at [https://github.com/ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed/blob/master/CONTRIBUTING.md](https://github.com/ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed/blob/master/CONTRIBUTING.md).\n\n## Thank-you's are in order {-}\n\nI'd like to thank the following for their helpful contributions:\n\n* E. David Aja ([\\@edavidaja](https://github.com/edavidaja)),\n* Monica Alexander ([\\@MJAlexander](https://github.com/MJAlexander)),\n* Shaan Amin ([\\@Shaan-Amin](https://github.com/Shaan-Amin)),\n* Malcolm Barrett ([\\@malcolmbarrett](https://github.com/malcolmbarrett)),\n* Hamed Bastan-Hagh ([\\@hamedbh](https://github.com/hamedbh)),\n* Adam Bear ([\\@adambear91](https://github.com/adambear91)),\n* Jenny Bigman ([\\@jennybigman](https://github.com/jennybigman)),\n* Louis Bliard ([\\@lbiard](https://github.com/lbiard)),\n* Philipp Boersch-Supan ([\\@pboesu](https://github.com/pboesu)),\n* Paul-Christian BÃ¼rkner ([\\@paul-buerkner](https://github.com/paul-buerkner)),\n* Damien Croteau-Chonka ([\\@dcroteau-chonka](https://github.com/dcroteau-chonka)),\n* Markus Gesmann ([\\@mages](https://github.com/mages)),\n* James Henegan ([\\@jameshenegan](https://github.com/jameshenegan)),\n* Mathieu Jones ([\\@00mathieu](https://github.com/00mathieu)),\n* William Lai ([\\@williamlai2](https://github.com/williamlai2)),\n* Sebastian Lobentanzer ([\\@slobentanzer](https://github.com/slobentanzer)),\n* Ed Merkle ([\\@ecmerkle](https://github.com/ecmerkle)),\n* Ladislas Nalborczyk ([\\@lnalborczyk](https://github.com/lnalborczyk)),\n* Will Petry ([\\@wpetry](https://github.com/wpetry)),\n* Randall Pruim ([\\@rpruim](https://github.com/rpruim)),\n* Gavin Simpson ([\\@gavinsimpson](https://github.com/gavinsimpson)),\n* Kathleen Sprouffske ([\\@sprouffske](https://github.com/sprouffske))\n* Richard Torkar ([\\@torkar](https://github.com/torkar)),\n* Brenton M. Wiernik ([\\@bwiernik](https://github.com/bwiernik)),\n* Stephen Wild ([\\@sjwild](https://github.com/sjwild)), and\n* Donald R. Williams ([\\@donaldRwilliams](https://github.com/donaldRwilliams)).\n\nScience is better when we work together.\n\n## License and citation {-}\n\nThis book is licensed under the Creative Commons Zero v1.0 Universal license. You can learn the details, [here](https://github.com/ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed/blob/master/LICENSE). In short, you can use my work. Just make sure you give me the appropriate credit the same way you would for any other scholarly resource. Here's the citation information:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n@book{kurzStatisticalRethinkingSecondEd2022,\n  title = {Statistical rethinking with brms, ggplot2, and the tidyverse: {{Second}} edition},\n  author = {Kurz, A. Solomon},\n  year = {2022},\n  month = {sep},\n  edition = {version 0.3.0},\n  url = {https://bookdown.org/content/4857/}\n}\n```\n:::\n\n\n## You can do this, too {-}\n\nThis project is powered by Yihui Xie's [-@R-bookdown] [**bookdown** package](https://bookdown.org), which makes it easy to turn R markdown files into HTML, PDF, and EPUB. Go [here](https://bookdown.org/yihui/bookdown/) to learn more about bookdown. While you're at it, also check out Xie, Allaire, and Grolemund's [*R markdown: The definitive guide*](https://bookdown.org/yihui/rmarkdown/). And if you're unacquainted with GitHub, check out Jenny Bryan's [-@bryanHappyGitGitHub2020] [*Happy Git and GitHub for the useR*](https://happygitwithr.com/). I've even [blogged](https://solomonkurz.netlify.app/post/how-bookdown/) about what it was like putting together the first version of this project.\n\nThe source code of the project is available on GitHub at [https://github.com/ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed](https://github.com/ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed).\n\n\n::: {.cell}\n\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}